clear;clc;
%研究光伏电池与逆变器的匹配组合问题
%1电池型号	2组件功率	3开路电压	4短路电流	5转换效率	6长	7宽	8厚	9价格
gfdc=[1	215	46.1	5.79	0.1684 	1580	808	40	14.9
2	325	46.91	8.93	0.1664 	1956	991	45	14.9
3	200	46.1	5.5	0.1870 	1580	808	35	14.9
4	270	38.1	8.9	0.1650 	1651	992	40	14.9
5	245	37.73	8.58	0.1498 	1650	991	40	14.9
6	295	45.92	8.64	0.1511 	1956	991	45	14.9
7	265	37.91	9.01	0.1621 	1650	991	40	12.5
8	320	45.98	8.89	0.1639 	1956	991	45	12.5
9	210	33.6	8.33	0.1598 	1482	992	35	12.5
10	240	36.9	8.46	0.1480 	1640	992	50	12.5
11	280	44.8	8.33	0.1598 	1956	992	50	12.5
12	295	45.1	8.57	0.1520 	1956	992	50	12.5
13	250	37.83	8.75	0.1499 	1668	1000	40	12.5
14	100	138	1.22	0.0699 	1300	1100	15	4.8
15	58	62.3	1.54	0.0617 	1321	711	20	4.8
16	100	99	1.65	0.0635 	1414	1114	35	4.8
17	90	115.4	1.26	0.0584 	1400	1100	22	4.8
18	100	100	1.64	0.0649 	1400	1100	25	4.8
19	4	26.7	0.35	0.0363 	310	355	16.7	4.8
20	4	12.6	0.7	0.0363 	615	180	16.7	4.8
21	8	26.7	0.7	0.0366 	615	355	16.7	4.8
22	12	26.7	1.05	0.0366 	920	355	16.7	4.8
23	12	26.7	0.9	0.0413 	818	355	16.7	4.8
24	50	55	1.75	0.0427 	1645	712	27	4.8];

%1逆变器型号	2额定输入电压	3额定输入电流	4允许最低输入电压	5允许最高输入电压	
%6额定输出电压 7额定输出电流	8额定输出功率(KW)	9逆变效率	10价格
nbq=[1	24 	25	21	32	220	2.2	0.4	0.840 	2900
2	24 	50	21	32	220	4.5	0.8	0.840 	4500
3	48 	24	42	64	220	4.5	0.8	0.860 	4500
4	48 	48	42	64	220	9	1.6	0.860 	6900
5	48 	73	42	64	220	13.6	2.4	0.860 	10200
6	48 	115	42	64	220	22.7	4	0.900 	15000
7	110 	30	99	150	220	13.6	2.4	0.900 	10200
8	110 	51	99	150	220	22.7	4	0.900 	15300
9	110 	101	99	150	220	45.5	8	0.920 	35000
10	110 	202	99	150	220	91	16	0.920 	63800
11	220 	5	180	300	220	4.5	0.8	0.940 	4500
12	220 	10	180	300	220	9.1	1.6	0.940 	6900
13	220 	15.2	180	300	220	13.6	2.4	0.940 	10300
14	220 	25.3	180	300	220	22.7	4	0.940 	15300
15	220 	37.9	180	300	220	34.1	6	0.940 	22000
16	220 	48.4	180	300	220	45.5	8	0.940 	35000
17	650 	40	250	800	230	15	10	0.973 	43750
18	650 	40	330	800	230	18	12	0.973 	54700];

A=[];
for j=1:18
    for i=1:24
       
        if(gfdc(i,3)<=nbq(j,5)&& gfdc(i,4)<=nbq(j,3))
            min_num = ceil(nbq(j,4)/gfdc(i,3)); %最少串联数目
            max_num = floor(nbq(j,5)/gfdc(i,3)); %最大串联数目；
            if(max_num <= min_num)
                max_num = min_num;
            end
            A=[A;j,i,min_num,max_num];    
        end     
    end    
end
 [m,n]=size(A);
 r=[];
 for i=1:m
     dianchizu_gl = A(i,4)*gfdc(A(i,2),3)*gfdc(A(i,2),4);%电池组功率
     if(dianchizu_gl>nbq(A(i,1),2)*nbq(A(i,1),3))
         r=[r;i];
     end
 end
 A(r,:)=[];
 
A


